<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Data Organization in Spreadsheets for Social Scientists: Quality Assurance</title><meta name="viewport" content="width=device-width, initial-scale=1"><script src="../assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" media="(prefers-color-scheme: light)" content="white"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="black"></head><body>
    <header id="top" class="navbar navbar-expand-md top-nav data"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="dc-logo" alt="Data Carpentry" src="../assets/images/data-logo.svg"></div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text"><li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul></li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../04-quality-assurance.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Data Organization in Spreadsheets for Social Scientists
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Data Organization in Spreadsheets for Social Scientists
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="../instructor/aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Organization in Spreadsheets for Social Scientists
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 69%" class="percentage">
    69%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 69%" aria-valuenow="69" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text"><li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul></li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../04-quality-assurance.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->

            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-intro.html">1. Introduction</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-format-data.html">2. Formatting Data Tables in Spreadsheets</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="02-common-mistakes.html">3. Formatting Problems</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-dates-as-data.html">4. Dates as Data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        5. Quality Assurance
        </span>
      </button>
    </div><!--/div.accordion-header-->

    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#validating-data-on-input">Validating data on input</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-exporting-data.html">6. Exporting Data</a>
    </div><!--/div.accordion-header-->

  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush lesson-resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="lesson-resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width lesson-resources"><a href="../instructor/aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">

            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/03-dates-as-data.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/05-exporting-data.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/03-dates-as-data.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Dates as Data
        </a>
        <a class="chapter-link float-end" href="../instructor/05-exporting-data.html" rel="next">
          Next: Exporting Data...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Quality Assurance</h1>
        <p>Last updated on 2024-09-02 |

        <a href="https://github.com/datacarpentry/spreadsheets-socialsci/edit/main/episodes/04-quality-assurance.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>



        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>

        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can we carry out basic quality assurance in spreadsheets?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Apply quality assurance techniques to limit incorrect data
entry.</li>
</ul></div>
</div>
</div>
</div>
</div>
<p>When you have a well-structured data table, you can use several
simple techniques within your spreadsheet to ensure the data you enter
is free of errors.</p>
<section><h2 class="section-heading" id="validating-data-on-input">Validating data on input<a class="anchor" aria-label="anchor" href="#validating-data-on-input"></a></h2>
<hr class="half-width"><p>When we input data into a cell of a spreadsheet we are typically not
constrained in the type of data we enter. In any one column, the
spreadsheets software will not warn us if we start to enter a mix of
text, numbers or dates in different rows. Even if we are not facing
constraints from the software, as a researcher we often anticipate that
all data in one column will be of a certain type. It is also possible
that the nature of the data contained in the table allows us to place
additional restrictions on the acceptable values for cells in a column.
For example a column recording age in years should be numeric, greater
than 0 and is unlikely to be greater than 120.</p>
<p>Excel allows us to specify a variety of data validations to be
applied to cell contents. If the validation fails, an error is raised
and the data we entered does not go into the particular cell.</p>
<p>We will be working with a couple of examples of data validation rules
but many others exist. For an overview of data validation rules
available, check out the <a href="https://support.office.com/en-us/article/Apply-data-validation-to-cells-29FECBCC-D1B9-42C1-9D76-EFF3CE5F7249" class="external-link">Excel
support page on data validation</a> or the <a href="https://books.libreoffice.org/en/CG24/CG2402-EnteringandEditingData.html#toc28" class="external-link">Validating
cell contents section of the LibreOffice Calc Guide</a>.</p>
<p>We will look at two examples:</p>
<ol style="list-style-type: decimal"><li>Restricting data to a numeric range</li>
<li>Restricting data to entries from a list</li>
</ol><div class="section level3">
<h3 id="restricting-data-to-a-numeric-range">Restricting data to a numeric range<a class="anchor" aria-label="anchor" href="#restricting-data-to-a-numeric-range"></a></h3>
<p>Looking again at the <a href="https://ndownloader.figshare.com/files/11492171" class="external-link">clean version of
the SAFI dataset</a>, we see that there are several columns with numeric
data. One example of this is the column <code>no_membrs</code>
representing the number of people in the household. We would expect this
always to be a positive integer, and so we should reject values like
<code>1.5</code> and <code>-8</code> as entry errors. We would also
reject values over a certain maximum - for example an entry like
<code>90</code> is probably the result of the researcher inputting
<code>9</code> and their finger slipping and also hitting the
<code>0</code> key. It is up to you as the researcher to decide what a
reasonable maximum value would be for your data, here we will assume
that there are no families with greater than 30 members.</p>
<p>Let’s start by opening the data validation feature using the
<code>no_membrs</code> column.</p>
<div class="tabs">
<nav><div id="nav-tab-1" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-1-Excel" name="Excel" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Excel" type="button" role="tab" aria-controls="nav-tabpanel-1-Excel" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-1-Excel">
  Excel
  </h3>
</button>
<button class="nav-link" id="nav-tab-1-Calc" name="Calc" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-1-Calc" type="button" role="tab" aria-controls="nav-tabpanel-1-Calc" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-1-Calc">
  Calc
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-1" class="tab-content">
<div id="nav-tabpanel-1-Excel" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-1-Excel">
<p>1. Select the <code>no_membrs</code> column.</p>
<p>2. Select the <code>Data</code> tab, and in the
<code>Data Tools</code> group, select the <code>Data Validation</code>
or <code>Validation Tools</code> (depending on your version of Excel).
The following pop-up will appear:</p>
<figure><img src="../fig/data-validation-tab-new.png" alt="Image of data validation tab in Excel" class="figure mx-auto d-block"></figure><p>3. Select ‘Whole number’ from the <code>Allow</code> drop down
options.</p>
<p>4. The window content will change. In the <code>Data</code> drop down
box, check that ‘between’ is selected. <code>Minimum</code> and
<code>Maximum</code> boxes will be provided for you to specify an
allowed range. You will see this:</p>
<figure><img src="../fig/data-validation-numbers-new.png" alt="Image of data validation tab for number rules in Excel" class="figure mx-auto d-block"></figure><p>5. Fill in the minimum and maximum values that make sense for your
data and click <code>OK</code>. Here we will choose a minimum of 1 and a
maximum of 30.</p>
</div>
<div id="nav-tabpanel-1-Calc" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-1-Calc">
<p>1. Select the <code>no_membrs</code> column.</p>
<p>2. On the <code>Data</code> tab select <code>Validity...</code>. The
following pop-up will appear:</p>
<figure><img src="../fig/data-validation-tab-LibreOffice-new.png" alt="Image of data validation tab in LibreOffice" class="figure mx-auto d-block"></figure><p>3. Select ‘Whole Numbers’ from the <code>Allow</code> drop down
options.</p>
<p>4. The window content will change. In the <code>Data</code> drop down
box, check that ‘valid range’ is selected. <code>Minimum</code> and
<code>Maximum</code> boxes will be provided for you to specify an
allowed range. You will see this:</p>
<figure><img src="../fig/data-validation-numbers-LibreOffice-new.png" alt="Image of data validation tab in LibreOffice" class="figure mx-auto d-block"></figure><p>5. Fill in the minimum and maximum values that make sense for your
data and click <code>OK</code>. Here we will choose a minimum of 1 and a
maximum of 30.</p>
</div>
</div>
</div>
<p>Now your data table will not allow you to enter a value that violates
the data validation rule you have created. To test this out, try to
enter a new value into the <code>no_membrs</code> column that is not
valid. The following error box will appear</p>
<div class="tabs">
<nav><div id="nav-tab-2" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-2-Excel" name="Excel" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Excel" type="button" role="tab" aria-controls="nav-tabpanel-2-Excel" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-2-Excel">
  Excel
  </h3>
</button>
<button class="nav-link" id="nav-tab-2-Calc" name="Calc" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-2-Calc" type="button" role="tab" aria-controls="nav-tabpanel-2-Calc" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-2-Calc">
  Calc
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-2" class="tab-content">
<div id="nav-tabpanel-2-Excel" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-2-Excel">
<figure><img src="../fig/error-invalid-data-new.png" alt="Image of error message for inputing invalid data in Excel" class="figure mx-auto d-block"></figure></div>
<div id="nav-tabpanel-2-Calc" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-2-Calc">
<figure><img src="../fig/error-invalid-data-LibreOffice-new.png" alt="Image of error message for inputing invalid data in LibreOffice" class="figure mx-auto d-block"></figure></div>
</div>
</div>
<p>You can also customize the resulting message to be more informative
by entering your own message in the <code>Error Alert</code> tab when
creating a data validation rule.</p>
<div class="tabs">
<nav><div id="nav-tab-3" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-3-Excel" name="Excel" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-3-Excel" type="button" role="tab" aria-controls="nav-tabpanel-3-Excel" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-3-Excel">
  Excel
  </h3>
</button>
<button class="nav-link" id="nav-tab-3-Calc" name="Calc" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-3-Calc" type="button" role="tab" aria-controls="nav-tabpanel-3-Calc" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-3-Calc">
  Calc
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-3" class="tab-content">
<div id="nav-tabpanel-3-Excel" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-3-Excel">
<p>Check that the <code>Style</code> is ‘Stop’. You can write ‘Invalid
number’ as the <code>Title</code> and ‘Number of households must be a
whole number between 1 and 30’ as the <code>Error Message</code>.</p>
<figure><img src="../fig/error_alert-new.png" alt="Image of Error Alert tab in Excel" class="figure mx-auto d-block"></figure><p>Now check what happens if you try to enter an invalid value.</p>
</div>
<div id="nav-tabpanel-3-Calc" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-3-Calc">
<p>Check that the <code>Action</code> is ‘Stop’. You can write ‘Invalid
number’ as the <code>Title</code> and ‘Number of households must be a
whole number between 1 and 30’ as the <code>Error Message</code>.</p>
<figure><img src="../fig/error_alert_LibreOffice-new.png" alt="Image of Error Alert tab in LibreOffice" class="figure mx-auto d-block"></figure><p>Now check what happens if you try to enter an invalid value.</p>
</div>
</div>
</div>
<p>You can also have an <code>Input message</code> that warns users of
the spreadsheet what values are accepted in cell that has data
validation.</p>
<div class="tabs">
<nav><div id="nav-tab-4" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-4-Excel" name="Excel" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-4-Excel" type="button" role="tab" aria-controls="nav-tabpanel-4-Excel" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-4-Excel">
  Excel
  </h3>
</button>
<button class="nav-link" id="nav-tab-4-Calc" name="Calc" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-4-Calc" type="button" role="tab" aria-controls="nav-tabpanel-4-Calc" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-4-Calc">
  Calc
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-4" class="tab-content">
<div id="nav-tabpanel-4-Excel" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-4-Excel">
<p>Select the <code>Input Message</code> tab. Add the title and input
message that is convenient for your task. In this example, we will write
‘Household members’ and ‘Please enter a whole number between 1 and
30’.</p>
<figure><img src="../fig/input_message-new.png" alt="Image of Input Message tab in Excel" class="figure mx-auto d-block"></figure><p>Now check what happens when you select a cell that has data
validation.</p>
</div>
<div id="nav-tabpanel-4-Calc" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-4-Calc">
<p>Select the <code>Input Help</code> tab. Add the title and input
message that is convenient for your task. In this example, we will write
‘Household members’ and ‘Please enter a whole number between 1 and
30’.</p>
<figure><img src="../fig/input_message_LibreOffice-new.png" alt="Image of Input Message tab in LibreOffice" class="figure mx-auto d-block"></figure><p>Now check what happens when you select a cell that has data
validation.</p>
</div>
</div>
</div>
<div id="exercise" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Apply a new data validation rule to one of the other numeric columns
in this data table. Discuss with the person sitting next to you what a
reasonable rule would be for the column you’ve selected. Be sure to
create an informative error alert and input message.</p>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="restricting-data-to-entries-from-a-list">Restricting data to entries from a list<a class="anchor" aria-label="anchor" href="#restricting-data-to-entries-from-a-list"></a></h3>
<p>Quality assurance can make data entry easier as well as more robust.
For example, if you use a list of options to restrict data entry, the
spreadsheet will provide you with a drop-downlist of the available
items. So, instead of trying to remember how to spell “mabatisloping”,
or whether or not you capitalized “cement” you can select the right
option from the list.</p>
<div class="tabs">
<nav><div id="nav-tab-5" class="nav nav-tabs" role="tablist">
<button class="nav-link active" id="nav-tab-5-Excel" name="Excel" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-5-Excel" type="button" role="tab" aria-controls="nav-tabpanel-5-Excel" aria-selected="true">
  <h3 class="tab-header" id="nav-tab-heading-5-Excel">
  Excel
  </h3>
</button>
<button class="nav-link" id="nav-tab-5-Calc" name="Calc" data-bs-toggle="tab" data-bs-target="#nav-tabpanel-5-Calc" type="button" role="tab" aria-controls="nav-tabpanel-5-Calc" aria-selected="false">
  <h3 class="tab-header" id="nav-tab-heading-5-Calc">
  Calc
  </h3>
</button>
</div>
</nav><div id="nav-tabContent-5" class="tab-content">
<div id="nav-tabpanel-5-Excel" class="tab-pane show active" role="tabpanel" aria-labelledby="nav-tab-5-Excel">
<p>1. Select the <code>respondent_wall_type</code> column.</p>
<p>2. Select the <code>Data</code> tab, and in the
<code>Data Tools</code> group, select the <code>Data Validation</code>
or <code>Validation Tools</code> (depending on your version of
Excel).</p>
<p>3. Select <code>List</code> from the <code>Allow</code> drop-down
menu.</p>
<p>4. The window will change to include a <code>Source</code> box, you
will see:</p>
<figure><img src="../fig/select-range-of-values-new.png" alt="Image of selecting a range of values to allow in Excel" class="figure mx-auto d-block"></figure><p>5. Type a list of all the values that you want to be accepted in this
column, separated by a comma (with no spaces). For us this will be
“grass,muddaub,burntbricks,sunbricks,cement”.</p>
<p>6. Create a meaningful error alert and input message, then click
‘OK’. In LibreOffice, there is no need to create an input message.</p>
</div>
<div id="nav-tabpanel-5-Calc" class="tab-pane" role="tabpanel" aria-labelledby="nav-tab-5-Calc">
<p>1. Select the <code>respondent_wall_type</code> column.</p>
<p>2. On the <code>Data</code> tab select <code>Validity...</code>.</p>
<p>3. Select <code>List</code> from the <code>Allow</code> drop-down
menu.</p>
<p>4. The window will change to include an <code>Entries</code> box, you
will see:</p>
<figure><img src="../fig/select-range-of-values-LibreOffice-new.png" alt="Image of selecting a range of values to allow in LibreOffice" class="figure mx-auto d-block"></figure><p>5. Type a list of all the values that you want to be accepted in this
column, and insert a new line by clicking enter after each value. Make
sure not to include spaces before or after the values. Your entries of
grass, muddaub, burntbricks, sunbricks and cement should look like
this:</p>
<figure><img src="../fig/filled-range-of-values-LibreOffice-new.png" alt="Image of filled in range of values to allow in LibreOffice" class="figure mx-auto d-block"></figure><p>6. Create a meaningful error alert and input message, then click
‘OK’.</p>
</div>
</div>
</div>
<p>We have now provided a restriction that will be validated each time
we try and enter data into the selected cells. When a cell in this
column is selected, a drop-down arrow will appear. When you click the
arrow, you will be able to select a value from your list. If you type a
value which is not on the list, you will get an error message. This not
only prevents data input errors, but also makes it easier and faster to
enter data.</p>
<div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise</h3>
<div class="callout-content">
<p>Apply a new data validation rule to one of the other categorical
columns in this data table. Discuss with the person sitting next to you
what a reasonable rule would be for the column you’ve selected. Be sure
to create an informative input message.</p>
</div>
</div>
</div>
<div id="tip" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip" class="callout-inner">
<h3 class="callout-title">Tip</h3>
<div class="callout-content">
<p>Typing a list of values where only a few possible values exist (like
“grass, muddaub, burntbricks, sunbricks, cement”) might be convenient,
but if the list is longer it makes sense to create it as a small table
(in a separate tab of the workbook). We can give the table a name and
then reference the table name as the source of acceptable inputs when
the source box appears in the Data Validation pop-out.</p>
<p>Using a table in this way makes the data entry process more flexible.
If you add or remove contents from the table, then these are immediately
reflected in any new cell entries based on this source. You can also
have different cells refer to the same table of acceptable inputs.</p>
</div>
</div>
</div>
<div id="tip-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="tip-1" class="callout-inner">
<h3 class="callout-title">Tip</h3>
<div class="callout-content">
<p>In the examples above we have applied data validation rules to an
existing spreadsheet to demonstrate how they work, however, you may have
noticed that data validation rules are not applied retroactively to data
that is already present in the cell. This means, for example, that if we
had already entered <code>150</code> in the <code>no_membrs</code>
column before applying our data validation rule, that cell would not be
flagged with a warning.</p>
<p>In some versions of Excel, you can click in the <code>Data</code>
tab, and in the <code>Data Tools</code> group, click in the little
drop-down arrow next to <code>Data Validation</code>, and then
<code>Circle invalid data</code>. This will put red circles around
invalid data entries. Note that it can be a bit slow with large data
files. You can do the same in LibreOffice Calc by going to
<code>Tools</code> tab, then <code>Detective</code> and selecting
<code>Mark invalid data</code>.</p>
<p>When using spreadsheets for data entry, it is a good idea to set up
data validation rules for each column when you set up your spreadsheet
(i.e. before you enter any data).</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points</h3>
<div class="callout-content">
<ul><li>Always copy your original spreadsheet file and work with a copy so
you don’t affect the raw data.</li>
<li>Use data validation to prevent accidentally entering invalid
data.</li>
</ul></div>
</div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/03-dates-as-data.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/05-exporting-data.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/03-dates-as-data.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Dates as Data
        </a>
        <a class="chapter-link float-end" href="../instructor/05-exporting-data.html" rel="next">
          Next: Exporting Data...
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/datacarpentry/spreadsheets-socialsci/edit/main/episodes/04-quality-assurance.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/datacarpentry/spreadsheets-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/spreadsheets-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/spreadsheets-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.9" class="external-link">sandpaper (0.16.9)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.4" class="external-link">varnish (1.0.4)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/spreadsheets-socialsci/instructor/04-quality-assurance.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Quality Assurance",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/spreadsheets-socialsci/instructor/04-quality-assurance.html",
  "identifier": "https://datacarpentry.github.io/spreadsheets-socialsci/instructor/04-quality-assurance.html",
  "dateCreated": "2017-05-25",
  "dateModified": "2024-09-02",
  "datePublished": "2024-11-05"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo --><script>
          var _paq = window._paq = window._paq || [];
          /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
          _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
          _paq.push(["setDomains", ["*.lessons.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
          _paq.push(["setDoNotTrack", true]);
          _paq.push(["disableCookies"]);
          _paq.push(["trackPageView"]);
          _paq.push(["enableLinkTracking"]);
          (function() {
              var u="https://matomo.carpentries.org/";
              _paq.push(["setTrackerUrl", u+"matomo.php"]);
              _paq.push(["setSiteId", "1"]);
              var d=document, g=d.createElement("script"), s=d.getElementsByTagName("script")[0];
              g.async=true; g.src="https://matomo.carpentries.org/matomo.js"; s.parentNode.insertBefore(g,s);
          })();
        </script><!-- End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

